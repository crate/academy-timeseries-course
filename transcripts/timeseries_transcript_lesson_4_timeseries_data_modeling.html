<h3>Video Transcript</h3>
<p><span data-contrast="none"></span><span data-contrast="none">​We will now demonstrate how CrateDB is far more than a pure time series database, supporting time series, but also JSON, Geospatial, Vectors, and Full-Text Search. There will be a demonstration of standard SQL, and how the different data types can be queried is demonstrated. Examples, mainly based on weather data, underpin these statements, like full-text search across textual attributes or user-generated comments over time.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><strong>Relational and Time Series Data:&nbsp;</strong></p>
<p><span data-contrast="none">We will start with time series data which follows a simple relational representation in CrateDB. The distinguishing characteristics of time series data include timestamped records and are typically append-only.&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<div>
<div><code><span>CREATE</span><span> </span><span>TABLE</span><span> </span><span>IF</span><span> </span><span>NOT</span><span> </span><span>EXISTS</span><span> weather_data (</span></code></div>
<div><code><span>&nbsp; &nbsp; ts </span><span>TIMESTAMP</span><span>,</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp;location</span><span> </span><span>VARCHAR</span><span>,</span></code></div>
<div><code><span>&nbsp; &nbsp; temperature DOUBLE,</span></code></div>
<div><code><span>&nbsp; &nbsp; humidity DOUBLE </span><span>CHECK</span><span> (humidity </span><span>&gt;=</span><span> </span><span>0</span><span>),</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp;PRIMARY KEY</span><span> (ts, </span><span>location</span><span>)</span></code></div>
<div><code><span>) </span><span>WITH</span><span> (column_policy</span><span>=</span><span>'dynamic'</span><span>);</span></code></div>
<div><span>&nbsp;</span></div>
</div>
<p><span data-contrast="none">Consider a table named weather data. In this table, we have columns for timestamp, location, temperature, and humidity. The humidity should also automatically be checked to be non-negative. The primary key is a combination of <code>ts</code> and <code>location</code>. We also want to use a dynamic column policy, that means to automatically add new columns at runtime.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">Now, let's see how we can insert data into this table. The <code>INSERT INTO</code> command is used to insert a record with a timestamp, location, temperature, and humidity values for San Francisco.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}"> </span></p>
<p><code>INSERT INTO weather_data (ts, location, temperature, humidity) VALUES ('2024-01-12T14:30:00', 'San Francisco', 17.5, 60.0);&nbsp;</code></p>
<div>&nbsp;</div>
<p><span data-contrast="none">And we can view the data in our table using a <code>SELECT</code> command.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">SELECT * FROM weather_data;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><span data-contrast="none">Now, let's say we want to add a new column wind speed to our table. Because we have set the column policy to dynamic, we can add this new column directly through an insert into command. This new column will be automatically added to our table.</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">INSERT INTO weather_data (ts, location, temperature, humidity, wind_speed) VALUES ('2024-01-12T14:31:00', 'San Francisco', 17.5, 60.0, 35.2);</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><span data-contrast="none">We can view the updated data in our table using the <code>SELECT</code> command. The new column is automatically indexed, so running a search query will be efficient, even across large data volumes.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">SELECT * FROM weather_data WHERE wind_speed &gt; 30;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><strong>Document/JSON Data:&nbsp;&nbsp;</strong></p>
<p><span data-contrast="none">CrateDB offers support for JSON. JSON is a commonly used format for data exchange, making it ideal for importing and exporting time series data. It also allows for the storage of arbitrary contextual data, providing additional details that can easily be appended to any time series data set. This added context can often prove helpful when analyzing patterns and trends. The <code>OBJECT</code> data type in CrateDB allows for a strict, dynamic, or ignored schema, depending on the specific use case. This means you can insert JSON directly as a string, and any new attributes will be automatically indexed. This combination of flexibility and power makes CrateDB an excellent choice for managing time series data.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">In this example, we further enhance our weather data table by adding contextual data. We use the <code>ALTER TABLE</code> command to add a new column sensor description of type object dynamic to store JSON data. This allows us to include additional details like quality of measurement and battery life of the sensor. We then insert a record with these new attributes into the table. </span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">CrateDB's dynamic schema allows us to immediately run a query to find devices with low battery. The <code>SELECT</code> statement identifies distinct locations where the battery life from the sensor description is less than 40. </span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">ALTER TABLE weather_data&nbsp; ADD COLUMN sensor_description OBJECT(DYNAMIC);</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><code><span data-contrast="none">INSERT INTO weather_data (ts, location, temperature, humidity, wind_speed, sensor_description) VALUES ('2024-01-12T14:32:00', 'San Francisco', 17.8, 61.0, 33.2, '{"quality":90, "battery_life":35}');</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><code><span data-contrast="none">SELECT DISTINCT(location), sensor_description['battery_life'] as battery_life FROM weather_data WHERE sensor_description['battery_life'] &lt; 40 limit 100;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><span data-contrast="none">To use JSON data for time series directly, we create a new table called <code>weather_data_json</code> with columns for timestamp, location, and vals which is of type <code>OBJECT</code>. </span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<div>
<div><code><span>CREATE</span><span> </span><span>TABLE</span><span> </span><span>weather_data_json</span><span> (</span></code></div>
<div><code><span>&nbsp; &nbsp; ts </span><span>TIMESTAMP</span><span>,</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp;location</span><span> </span><span>VARCHAR</span><span>,</span></code></div>
<div><code><span>&nbsp; &nbsp; vals </span><span>OBJECT</span><span>,</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp;PRIMARY KEY</span><span> (ts, </span><span>location</span><span>)</span></code></div>
<div><code><span>);</span></code></div>
<div><span>&nbsp;</span></div>
</div>
<p><span data-contrast="none">We then insert a record into the table with a timestamp, location, and values for temperature and humidity in JSON format. Using a <code>SELECT</code> command, we can view the data in our table. </span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">INSERT INTO weather_data_json (ts, location, vals) VALUES ('2024-01-12T14:30:00', 'San Francisco', '{"temperature":17.5, "humidity":60.0}');</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><code><span data-contrast="none">SELECT * FROM weather_data_json;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><span data-contrast="none">We can also add more attributes to our JSON data on the fly, such as wind speed, by simply including it in the <code>INSERT INTO</code> statement. The updated data, including the new wind speed attribute, can be viewed and filtered by immediately. </span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">INSERT INTO weather_data_json (ts, location, vals) VALUES ('2024-01-12T14:31:00', 'San Francisco', '{"temperature":17.5, "humidity":60.0, "wind_speed":35.6}');</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><code><span data-contrast="none">SELECT * FROM weather_data_json;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><strong>Full-Text Search:&nbsp;</strong></p>
<p><span data-contrast="none">In addition to numerical and categorical data, CrateDB is also highly effective in handling textual data. This could include attributes such as machine status, user comments, or log files, which can be valuable sources of information for analysis. Furthermore, CrateDB is equipped with robust full-text search capabilities. This allows for efficient searching through these textual data, not just for exact matches, but also for typos or specific phrases and even synonyms. With CrateDB, you can efficiently perform a full-text search through your data and extract the insights you need.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">Let us have a look at a table for web server logs. It contains a timestamp, IP address, request method, the called HTTP endpoint, a response status and the user agent.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}"></span></p>
<div>
<div><code><span>CREATE</span><span> </span><span>TABLE</span><span> </span><span>web_server_logs</span><span> (</span></code></div>
<div><code><span>&nbsp; &nbsp; ts </span><span>TIMESTAMP</span><span>,</span></code></div>
<div><code><span>&nbsp; &nbsp; ip_address </span><span>TEXT</span><span>,</span></code></div>
<div><code><span>&nbsp; &nbsp; request_method </span><span>TEXT</span><span>,</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp;endpoint</span><span> </span><span>TEXT</span><span> </span><span>INDEX</span><span> </span><span>USING</span><span> </span><span>FULLTEXT</span><span>,</span></code></div>
<div><code><span>&nbsp; &nbsp; response_status </span><span>INT</span><span>,</span></code></div>
<div><code><span>&nbsp; &nbsp; user_agent </span><span>TEXT</span></code></div>
<div><code><span>);</span></code></div>
<div><span>&nbsp;</span></div>
</div>
<p><span data-contrast="none">We insert a few rows calls to the home, login and products endpoints.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<div>
<div><code><span>INSERT INTO</span><span> web_server_logs (ts, ip_address, request_method, </span><span>endpoint</span><span>, response_status, user_agent)</span></code></div>
<div><code><span>VALUES</span></code></div>
<div><code><span>(</span><span>'2024-01-12T08:00:00'</span><span>, </span><span>'192.168.1.1'</span><span>, </span><span>'GET'</span><span>, </span><span>'/home'</span><span>, </span><span>200</span><span>, </span><span>'Mozilla/5.0'</span><span>),</span></code></div>
<div><code><span>(</span><span>'2024-01-12T08:05:23'</span><span>, </span><span>'192.168.1.2'</span><span>, </span><span>'POST'</span><span>, </span><span>'/login'</span><span>, </span><span>303</span><span>, </span><span>'Mozilla/5.0'</span><span>),</span></code></div>
<div><code><span>(</span><span>'2024-01-12T08:10:45'</span><span>, </span><span>'192.168.1.3'</span><span>, </span><span>'GET'</span><span>, </span><span>'/products'</span><span>, </span><span>200</span><span>, </span><span>'Mozilla/5.0'</span><span>);</span></code></div>
<div><span>&nbsp;</span></div>
</div>
<p><span data-contrast="none">Imagine, users can type search criteria that will be used in the queries. Instead of typing home, two letters are mixed up. The fuzzy search capabilities in CrateDB can easily cope with these misspellings. This query uses a fuzziness of five, which means there can be a Levenshtein distance of five or five letters are allowed to be different in the search term and the actual term in the database.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">SELECT * FROM web_server_logs&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">WHERE MATCH(endpoint, 'hmoe') USING best_fields WITH (fuzziness=5);</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><span data-contrast="none">Of course, full-text search can be combined with other attributes as well. For example, all successful HTTP calls to the home endpoint can be found by adding the condition of <code>response_status</code> equals 200.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<div>
<div><code><span>SELECT</span><span> </span><span>*</span><span> </span><span>FROM</span><span> web_server_logs</span></code></div>
<div><code><span>WHERE</span><span> </span><span>MATCH</span><span>(</span><span>endpoint</span><span>, </span><span>'hmoe'</span><span>) </span></code></div>
<div><code><span>USING</span><span> best_fields </span></code></div>
<div><code><span>WITH</span><span> (fuzziness</span><span>=</span><span>5</span><span>) </span><span>AND</span><span> response_status </span><span>=</span><span> </span><span>200</span><span>;</span></code></div>
<div><span>&nbsp;</span></div>
</div>
<p><span data-contrast="none">There are many more options available, please refer to the CrateDB documentation for all the details on full-text search.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><strong>Vector Search:&nbsp;</strong></p>
<p><span data-contrast="none">CrateDB supports the float vector data type for columns, which is ideal for storing floating point vectors. This data type can handle up to 2048 dimensions, accommodating a wide array of data complexities. To efficiently index these vectors, CrateDB utilizes a Hierarchical Navigable Small World graph, an efficient index for searching similar vectors in high dimensional spaces. An Approximate k-Nearest Neighbor Search can be done with the k n n match function based on an euclidean distance function. This combination of features enhances CrateDB's ability to handle complex, multi-dimensional data. The KNN match can be combined with other conditions as well.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">Vectors are very prominent nowadays when it comes to semantic search, where we also see a big area of application. In this example, we focus on finding similar patterns as a common problem in time series analysis. Although there are multiple different ways to identify similar patterns, executing a similarity search on a vector is a viable solution. One could create vectors of various features like minimum or maximum values, moving averages etc. In our example we want to find weeks with similar temperature patterns. Therefore, we create a table called weather patterns weekly that stores the location, the particular week and the maximum temperatures of every single day in a vector.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">CREATE TABLE weather_patterns_weekly (location TEXT, week TIMESTAMP, max_temp_pattern FLOAT_VECTOR(7));</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><span data-contrast="none">To populate this table, we aggregate the temperature values of our weather data table in the following way. The common table expression of this statement truncates the date of measurements to weeks and days and calculates the maximum temperature per location, week, and day. The outer select statement groups the data by location and week to aggregate the daily maximum values into a float vector. The resulting data is inserted into the weather patterns weekly table.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<div>
<div><code><span>INSERT INTO</span><span> weather_patterns_weekly</span></code></div>
<div><code><span>WITH</span><span> daily_temperatures </span><span>AS</span><span> (</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp; SELECT</span><span> </span><span>location</span><span>, date_trunc(</span><span>'week'</span><span>, </span><span>timestamp</span><span>) w, date_trunc(</span><span>'day'</span><span>, </span><span>timestamp</span><span>) d, </span><span>max</span><span>(temperature) t_max</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp; FROM</span><span> weather_data</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp; GROUP BY</span><span> </span><span>location</span><span>, w, d</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp; ORDER BY</span><span> </span><span>location</span><span>, w, d</span></code></div>
<div><code><span>)</span></code></div>
<br>
<div><code><span>SELECT</span><span> </span><span>location</span><span>, w, array_agg(t_max)::FLOAT_VECTOR </span><span>FROM</span><span> daily_temperatures</span></code></div>
<div><code><span>GROUP BY</span><span> </span><span>location</span><span>, w;</span></code></div>
<div><span>&nbsp;</span></div>
</div>
<p><span data-contrast="none">As we can see, the result contains a vector of daily temperatures per location and week.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">SELECT * FROM weather_patterns_weekly ORDER BY location, week;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><span data-contrast="none">In order to find similar weeks, we execute a K nearest neighbour search for the week of twentieth February 2023 represented by the given timestamp. In order to do so, we select the temperature pattern of the week of interest and execute a similarity search on the temperature pattern and want to find the top 10 most similar weeks. The score value represents the similarity. Please note that this value is not the actual distance of vectors, but an arbitrary value to rank the results. For more details on the score value, please refer to the documentation.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<div>
<div><code><span>SELECT</span><span> </span><span>*</span><span>, _score</span></code></div>
<div><code><span>FROM</span><span> weather_patterns_weekly</span></code></div>
<div><code><span>WHERE</span><span> knn_match(</span></code></div>
<div><code><span>&nbsp; &nbsp; max_temp_pattern,</span></code></div>
<div><code><span>&nbsp; &nbsp; (</span><span>SELECT</span><span> max_temp_pattern </span><span>FROM</span><span> weather_patterns_weekly </span><span>WHERE</span><span> </span><span>location</span><span>=</span><span>'Berlin'</span><span> </span><span>and</span><span> </span><span>week</span><span> </span><span>=</span><span> </span><span>1676851200000</span><span>),</span></code></div>
<div><code><span>&nbsp;</span><span>&nbsp; &nbsp;10</span></code></div>
<div><code><span>) </span><span>ORDER BY</span><span> _score </span><span>DESC</span></code></div>
<div><code><span>LIMIT</span><span> </span><span>10</span><span>;</span></code></div>
</div>
<p>&nbsp;</p>
<p><span data-contrast="none">The results provide us with various weeks that have a similar temperature patterns.&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">If we look at a visualization of the similar data sets, we can see that the weekly temperature patterns look similar to each other. Obviously, this example is very simple and for a real comparison of patterns we should do a proper normalization of data first. Still, it shows how the similarity search can be used to detect patterns.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">The vector search can be used for a lot of different cases, especially when creating embeddings of textual data, videos, audio files or other binaries. This is not part of this course, please refer to the CrateDB documentation and other tutorials, for example, about CrateDB’s lang chain integration on how to work with large language models.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><strong>Geospatial Data:&nbsp;&nbsp;</strong></p>
<p><span data-contrast="none">Geospatial data plays a critical role in time series solutions, offering a spatial context to the time-stamped data. This data type allows us to track changes over time in a particular geographic area, which can be vital for numerous applications. For example, in the transportation industry, geospatial data can help track vehicle routes and monitor traffic conditions over time. In environmental studies, it can be used to monitor changes in weather patterns or wildlife movements. By integrating geospatial data into time series analysis, we can uncover spatial trends and patterns, enhancing our understanding and enabling more informed decision-making.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">For this introduction, let us create a simple table for the cities that are referenced in the weather data.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">CREATE TABLE cities ( name TEXT, country TEXT, location GEO_POINT );</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code></p>
<p><span data-contrast="none">We want to insert a few rows into the new table.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<div>
<div><code><span>INSERT INTO</span><span> cities (</span><span>name</span><span>, country, </span><span>location</span><span>) </span><span>VALUES</span></code></div>
<div><code><span>&nbsp; &nbsp; (</span><span>'Redwood City'</span><span>, </span><span>'United States'</span><span>, [-122.2364, 37.4852]),</span></code></div>
<div><code><span>&nbsp; &nbsp; (</span><span>'Berlin'</span><span>, </span><span>'Germany'</span><span>, [13.4050, 52.5200]),</span></code></div>
<div><code><span>&nbsp; &nbsp; (</span><span>'Dornbirn'</span><span>, </span><span>'Austria'</span><span>, [9.7433, 47.4125]),</span></code></div>
<div><code><span>&nbsp; &nbsp; (</span><span>'Vienna'</span><span>, </span><span>'Austria'</span><span>, [16.3738, 48.2082]),</span></code></div>
<div><code><span>&nbsp; &nbsp; (</span><span>'Zurich'</span><span>, </span><span>'Switzerland'</span><span>, [8.5417, 47.3769]);</span></code></div>
<div><span>&nbsp;</span></div>
</div>
<p><span data-contrast="none">Selecting this data shows that CrateDB interprets the data correctly and, for example, opens the coordinates on OpenStreetMap when clicking on the arrow icon.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><code><span data-contrast="none">SELECT * FROM cities;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></code><span data-contrast="none">&nbsp;</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559685&quot;:720,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">The geospatial data can now be used, for example, to visualize weather conditions on a map or automatically figure out if, for example, storm events will cross a certain country that is defined via its geo shape. All of it can be done via the available functions to query geo data directly in CrateDB.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><strong>Binaries:&nbsp;</strong></p>
<p><span data-contrast="none">Binary Large Object or BLOB is another key data type that can be effectively managed in time series solutions. This type of data can range from images and audio files to logs or even serialized machine learning models. Storing and retrieving BLOB data efficiently is crucial in many time series applications, especially when dealing with multimedia content or large log files. CrateDB supports BLOB storage, allowing users to store and retrieve binary data efficiently, making it an excellent choice for managing complex time series data with various data types.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">They are stored in separate tables which allows for different disk configurations than the regular database files. Upload and download can be executed via the HTTP interface of CrateDB. All metadata of binaries is available via SQL.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">As an alternative, binaries can also be stored in text columns using a base64 encoding.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>
<p><span data-contrast="none">This closes our overview of how CrateDB handles various datatypes that are relevant for comprehensive time series data management.</span><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:276}">&nbsp;</span></p>